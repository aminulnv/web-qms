# Vercel Deployment Guide

## âœ… What to Commit to GitHub

**Commit these files:**
- âœ… All your HTML, CSS, JS files (except config files)
- âœ… `package.json` (with build scripts)
- âœ… `vercel.json` (build configuration)
- âœ… `generate-config.js` (generates config files from env vars)
- âœ… `.env.example` (template file with placeholders)
- âœ… `intercom-config.example.js` (template file)
- âœ… `supabase-config.example.js` (template file)
- âœ… `.gitignore` (ensures secrets aren't committed)

**DO NOT commit:**
- âŒ `.env` (your local credentials)
- âŒ `intercom-config.js` (will be generated by Vercel)
- âŒ `supabase-config.js` (will be generated by Vercel)

## ğŸ”§ How It Works

1. **Vercel pulls your code from GitHub** (without config files)
2. **During build**, Vercel runs `npm run build`
3. **The build script** runs `generate-config.js`
4. **generate-config.js** reads environment variables from Vercel's settings
5. **Config files are generated** with your production credentials
6. **Your site deploys** with the generated config files

## ğŸ“‹ Setup Steps

### Step 1: Configure Vercel Environment Variables

You've already done this! âœ… In Vercel dashboard, add these environment variables:

- `INTERCOM_ACCESS_TOKEN`
- `INTERCOM_APP_ID`
- `SUPABASE_URL`
- `SUPABASE_ANON_KEY`

**Important:** Set them for **"All Environments"** or specifically for **"Production"**.

### Step 2: Commit These Files to GitHub

Make sure these are in your repository:

```bash
# Files to commit
git add package.json
git add vercel.json
git add generate-config.js
git add .env.example
git add intercom-config.example.js
git add supabase-config.example.js
git add .gitignore

# All your HTML/CSS/JS files (except config files)
git add *.html
git add *.js
git add *.css
# ... etc
```

### Step 3: Verify .gitignore

Make sure these are in `.gitignore`:

```
.env
intercom-config.js
supabase-config.js
```

### Step 4: Deploy

When you push to GitHub:
1. Vercel automatically detects the push
2. Runs `npm install` to install dependencies
3. Runs `npm run build` (which generates config files from Vercel env vars)
4. Deploys your site with the generated config files

## ğŸ” Verify It's Working

After deployment, check your Vercel build logs:
1. Go to your Vercel project â†’ Deployments
2. Click on a deployment
3. Check the build logs
4. You should see: `âœ… Config files generated successfully!`

## ğŸš¨ Troubleshooting

**Problem:** `git diff --quiet HEAD^ HEAD ./` error
- **Solution:** This error is fixed! The `ignoreCommand` has been removed from `vercel.json`.

**Problem:** Config files not generated
- **Solution:** Check Vercel build logs. Ensure environment variables are set correctly in Vercel dashboard.

**Problem:** Site works locally but not on Vercel
- **Solution:** Verify all 4 environment variables are set in Vercel (not just some of them).

**Problem:** Build fails with "Missing required environment variables"
- **Solution:** 
  1. Go to Vercel Dashboard â†’ Your Project â†’ Settings â†’ Environment Variables
  2. Verify all 4 variables are set: `INTERCOM_ACCESS_TOKEN`, `INTERCOM_APP_ID`, `SUPABASE_URL`, `SUPABASE_ANON_KEY`
  3. Make sure they're set for the correct environment (Production, Preview, or All)

**Problem:** Build fails with package errors
- **Solution:** Make sure `dotenv` is in `devDependencies` in `package.json` (already done âœ…).

## ğŸ“ Summary

**What gets committed to GitHub:**
- âœ… Code files
- âœ… Build scripts
- âœ… Example/template files
- âŒ **No actual credentials** (all in Vercel environment variables)

**What happens on Vercel:**
- âœ… Pulls code from GitHub
- âœ… Runs build script
- âœ… Generates config files from Vercel environment variables
- âœ… Deploys with production config files

Your secrets are safe! ğŸ‰

